# 概述

direnv是一个环境变量管理工具，它可以扩展你的shell的环境变量。它的工作原理是根据当前目录动态地改变环境变量。具体来说，当你进入一个目录时，它会加载该目录下的.envrc文件来改变环境变量，这个过程被称为"装载"（loading）。相反，当你离开该目录时，它会卸载这些环境变量，这个过程被称为"卸载"（unloading）。

# 功能

direnv的主要功能是管理和隔离环境变量。它可以让你在不同的项目中使用不同的环境变量，而不需要手动地去更改它们。这对于开发者来说非常有用，因为他们经常需要在不同的项目中切换，而每个项目可能需要不同的环境变量设置。通过使用direnv，开发者可以为每个项目创建一个.envrc文件，定义该项目所需的环境变量，然后direnv会自动地根据当前目录来装载和卸载这些环境变量。

# 应用场景

1. 项目依赖管理：在Python项目中，你可能需要使用不同版本的Python或者不同的Python库。通过使用direnv，你可以为每个项目设置不同的Python路径和库。例如，你可以在.envrc文件中设置PYTHONPATH环境变量，指向该项目所需的Python库的路径。

2. 保密信息管理：如果你的项目需要一些保密的环境变量（如API密钥），你可以使用direnv来管理这些信息，而不是把它们硬编码到你的代码中。你可以在.envrc文件中设置这些保密的环境变量，然后在代码中通过环境变量来使用这些信息。这样，你就可以避免把这些保密信息暴露在代码中，同时，你也可以方便地在不同的环境中使用不同的保密信息。

# 用法

## 安装direnv

在Ubuntu上，你可以使用以下命令来安装direnv：

```sh
sudo apt-get install direnv
```

安装完成后，你需要在你的shell配置文件（如.bashrc或.zshrc）中添加以下行来启用direnv：

```sh
eval "$(direnv hook bash)" 
```

## 创建.envrc文件

在你的项目目录中，创建一个.envrc文件，并在其中添加一些环境变量。例如，你可以使用以下命令来创建一个.envrc文件，并设置API_KEY环境变量：

```sh
echo export API_KEY=my_secret_key > .envrc
```

## 允许direnv加载.envrc文件

由于安全原因，direnv默认不会加载.envrc文件。你需要使用以下命令来允许direnv加载该文件：

```sh
direnv allow
```

现在，每当你进入该目录时，API_KEY环境变量就会被设置为my_secret_key。当你离开该目录时，API_KEY环境变量就会被卸载，这样就可以防止这个保密信息被其他项目或命令误用。