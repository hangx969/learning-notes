# 方案对比
## Etcd
优点：全量备份，包含集群所有资源；备份不依赖于任何K8s API和版本，可用于灾难恢复。
缺点：全量恢复，不可恢复部分资源；不支持数据迁移，恢复时必须保持配置统一（K8s版本、各种IP、主机名都要保持一致）。

## GitOps
优点：符合GitOps规范，可以基于代码仓库进行配置控制、回滚、可审计、可重复部署
缺点：配置漂移，资源文件过多，管理复杂。

## Velero
优点：灵活性高，支持按照namespace、集群等方式备份，支持定时备份、全量备份，支持备份应用数据，支持跨集群备份恢复数据，支持细粒度恢复。
缺点：需要S3存储备份数据，备份应用数据功能有限，K8s版本依赖

关于备份应用数据：
- 不推荐使用velero备份，他是崩溃一致性。数据库应用，直接用velero备份运行中的数据库的PV数据目录不可靠，是有其他事务逻辑约束的，还原会出问题。
- 怎么备份应用数据：用数据库自己的工具，比如mysqldump、pgdump等。能保证应用一致性

> 总之，这些约束是应用层的逻辑，文件系统级的备份工具（如 Velero）无法理解和保证，所以必须使用数据库自己的备份工具（如mysqldump、pg_dump），它们从应用层理解这些约束，才能保证备份的可靠性。


# Velero介绍
专门为K8s设计的备份容灾工具，主要用于以下场景：
1. 备份、恢复、灾备K8s集群的各类资源
2. 灵活迁移K8s的数据，可以从集群A迁移到集群B，可以从ns A迁移到ns B
3. 手动及周期备份、最小范围恢复（只恢复某个ns内的某个资源）
核心组件：
- 服务端：处理备份和恢复操作，需要部署在K8s集群中，需要配置对象存储后端
- 