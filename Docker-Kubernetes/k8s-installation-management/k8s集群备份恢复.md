# 方案对比
## Etcd
优点：全量备份，包含集群所有资源；备份不依赖于任何K8s API和版本，可用于灾难恢复。
缺点：全量恢复，不可恢复部分资源；不支持数据迁移，恢复时必须保持配置统一（K8s版本、各种IP、主机名都要保持一致）。

## GitOps
优点：符合GitOps规范，可以基于代码仓库进行配置控制、回滚、可审计、可重复部署
缺点：配置漂移，资源文件过多，管理复杂。

## Velero
优点：灵活性高，支持按照namespace、集群等当时备份，支持定时备份，支持备份应用数据，支持跨集群备份恢复数据，支持细粒度恢复
缺点：需要S3存储备份数据，备份应用数据功能有限，K8s版本依赖

关于备份应用数据：
- 不推荐使用velero备份，他是崩溃一致性。数据库应用，直接用velero备份运行中的数据库的PV数据目录不可靠，是有其他事务逻辑约束的，还原会出问题。
- 怎么备份应用数据：用数据库自己的工具，比如mysqldump、pgdump等。能保证应用一致性

> 总之，这些约束是应用层的逻辑，文件系统级的备份工具（如 Velero）无法理解和保证，所以必须使用数据库自己的备份工具（如mysqldump、pg_dump），它们从应用层理解这些约束，才能保证备份的可靠性。

A
