# 两地三中心架构

![image-20251115095329861](https://raw.githubusercontent.com/hangx969/upload-images-md/main/202511150953992.png)

- A是生产中心。A和B是同城双中心。A的数据会实时同步到B同城灾备中心，专线连接速度会很快。
- B的配置可能和A一样，准备随时接收流量进来。B也可能是双活，接收20%流量。
- C是灾备中心。配置较低，平常闲置。不会接收生产流量进来。
两地三中心是一种主备模式，有一个同城灾备中心和一个异地灾备中心，但是这两个中心大部分情况下不会接受不了生产流量，造成资源浪费。

# 异地多活
异地多活是两地三中心的高级形态，可以实现不同城市建立独立数据中心的高可用架构。异地多活的每个中心均在承载业务流量，并且每个中心之间相互同步数据。
- 异地：指多个地理上的城市，可以是多个。用户流量可以智能分配到多个城市的数据中心。
- 多活：多个中心同时对外提供服务，共同成承担用户流量，没有主备之分。

不需要再做灾备中心，因为每个中心之间数据是相互同步的。
每个机房里面的配置都是一样的，请求可以在一个机房内部完成全链路。不需要跨机房访问数据。
现在分布式数据库的普及，使得异地多活配置起来也更方便了。

![image-20251115095652754](https://raw.githubusercontent.com/hangx969/upload-images-md/main/202511150956881.png)


# 智能DNS工作原理
做异地多活最重要的就是智能DNS，让不同地域的用户访问就近流量。

![image-20251115095829129](https://raw.githubusercontent.com/hangx969/upload-images-md/main/202511150958186.png)



# 单集群异地多活架构

![image-20251115095952081](https://raw.githubusercontent.com/hangx969/upload-images-md/main/202511150959153.png)



![image-20251115100112497](https://raw.githubusercontent.com/hangx969/upload-images-md/main/202511151001603.png)
